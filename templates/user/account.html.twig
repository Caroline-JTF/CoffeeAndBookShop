{% extends "base.html.twig" %}

{% block title %}Mon compte{% endblock %}

{% block body %}

    <style>
        #navbar, footer{
            display: none !important;
        }
    </style>

    <nav class="navbar navbar-dark navbar-expand-lg" style="background : #25252b;">

        <!-- Navbar brand  -->
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6" href="{{ path('app_default_home_page') }}">Coffee and Book</a>

        <!-- Navbar toggler -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

    </nav>

    <div class="row">

        <div id="sidebarMenu" class="col-md-3 d-md-block sidebar collapse" style="background: #25252b;">

            <div class="nav position-sticky pt-3 nav flex-column" id="menuTabs" role="tablist">

                <a class="nav-link text-white text-primary-hover  my-2 active" href="#info" id="infoTab" data-bs-toggle="tab" role="tab" aria-controls="info" aria-selected="true">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <circle cx="12" cy="7" r="4" />
                        <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
                    </svg>
                    Mon compte
                </a>

                <a class="nav-link text-white text-primary-hover my-2" href="#event" id="eventTab" data-bs-toggle="tab" role="tab" aria-controls="event">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-event" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <rect x="4" y="5" width="16" height="16" rx="2" />
                        <line x1="16" y1="3" x2="16" y2="7" />
                        <line x1="8" y1="3" x2="8" y2="7" />
                        <line x1="4" y1="11" x2="20" y2="11" />
                        <rect x="8" y="15" width="2" height="2" />
                    </svg>
                    Mes évènements
                </a>

                <a class="nav-link text-white text-primary-hover my-2" href="#review" id="reviewTab" data-bs-toggle="tab" role="tab" aria-controls="review">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-writing-sign" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 19c3.333 -2 5 -4 5 -6c0 -3 -1 -3 -2 -3s-2.032 1.085 -2 3c.034 2.048 1.658 2.877 2.5 4c1.5 2 2.5 2.5 3.5 1c.667 -1 1.167 -1.833 1.5 -2.5c1 2.333 2.333 3.5 4 3.5h2.5" />
                        <path d="M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z" />
                        <path d="M16 7h4" />
                    </svg>
                    Mes avis
                </a>

                <hr>

                <a class="nav-link text-white my-2" href="mailto:carolinejtf@gmail.com">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <rect x="3" y="5" width="18" height="14" rx="2" />
                        <polyline points="3 7 12 13 21 7" />
                    </svg>
                    Nous contacter
                </a>

                <a class="nav-link text-white my-2" href="{{ path('app_default_home_page') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <polyline points="5 12 3 12 12 3 21 12 19 12" />
                        <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
                        <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
                    </svg>
                    Accueil
                </a>

            </div>

        </div>

        <main class="col-md-9 px-md-4 min-vh-100" style="background: #f9f9f9;">

            {% for message in app.flashes('success') %}
                <div class="alert alert-success" role="alert">{{message}}</div>
            {% endfor %}

            {% for message in app.flashes('danger') %}
                <div class="alert alert-danger" role="alert">{{message}}</div>
            {% endfor %}

            {% for message in app.flashes('info') %}
                <div class="alert alert-info" role="alert">{{message}}</div>
            {% endfor %}

            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Bienvenue sur votre espace personnel {{ app.user.firstname}}</h1>
            </div>

            <div class="tab-content" id="menuContent">

                <!-- INFO -->
                <style>
                    .container-information{
                        width: 100%;
                        margin-top: 3rem;
                    }
                    .information{
                        width: 80%;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        flex-direction: column;
                        margin: 0 auto;
                    }
                    .info{
                        display: flex;
                        width: 100%;
                    }
                    .info p{
                        width: 100%;
                        height: 50px;
                        line-height: 50px;
                        text-align: center;
                        background-color: #f5a637;
                        color: #f9f9f9;
                        border: 1px solid #f9f9f9;
                    }
                </style>
                <div class="tab-pane fade show active" id="info" role="tabpanel" aria-labelledby="infoTab">

                    <div class="row">

                        <h2>Vos informations</h2>

                        <section class="container-information">
                            <div class="information">

                                <div class="info my-2">
                                    <p>Nom</p>
                                    <p>{{ app.user.lastname }}</p>
                                </div>

                                <div class="info my-2">
                                    <p>Prénom</p>
                                    <p>{{ app.user.firstname}}</p>
                                </div>

                                <div class="info my-2">
                                    <p>N° de téléphone</p>
                                    <p>{{ app.user.phoneNumber}}</p>
                                </div>

                                <div class="info my-2">
                                    <p>Adresse email</p>
                                    <p>{{ app.user.email}}</p>
                                </div>
                            </div>

                            <div class="text-center my-5">
                                <a class="btn btn-outline-primary" href="{{ path('app_user_update', {'id': app.user.id}) }}">
                                    Modifier les informations
                                </a>
                            </div>

                        </section>

                    </div>

                </div>

                <!-- EVENT -->
                <style>
                    .event tbody td{
                        border-bottom: 1px solid #C7C7C7FF;
                        padding-top: 20px !important;
                        padding-bottom: 10px !important;
                    }
                    table a{
                        text-decoration: none !important;
                        cursor: pointer;
                    }
                    .badge {
                        --bs-badge-padding-x: 0.65em;
                        --bs-badge-padding-y: 0.35em;
                        --bs-badge-font-size: 0.75em;
                        --bs-badge-font-weight: 700;
                        --bs-badge-color: #fff;
                        --bs-badge-border-radius: 0.375rem;
                        display: inline-block;
                        padding: var(--bs-badge-padding-y) var(--bs-badge-padding-x);
                        font-size: var(--bs-badge-font-size);
                        font-weight: var(--bs-badge-font-weight);
                        line-height: 1;
                        color: var(--bs-badge-color);
                        text-align: center;
                        white-space: nowrap;
                        vertical-align: baseline;
                    }
                    .text-bg-success {
                        color: #fff!important;
                        background-color: RGBA(25,135,84,var(--bs-bg-opacity,1))!important;
                    }
                    .text-bg-danger {
                        color: #fff!important;
                        background-color: RGBA(220,53,69,var(--bs-bg-opacity,1))!important;
                    }
                    .text-bg-secondary {
                        color: #fff!important;
                        background-color: RGBA(108,117,125,var(--bs-bg-opacity,1))!important;
                    }
                    .rounded-pill {
                        border-radius: 50px !important;
                    }
                </style>
                <div class="tab-pane fade" id="event" role="tabpanel" aria-labelledby="eventTab">

                    <div class="row">

                        <h2>Vos évènements</h2>

                        <div class="col-md-12">

                            <div class="table-wrap">

                                <table class="event table table-hover table-responsive-xl">

                                    <thead>

                                    <tr>
                                        <th>Nom de l'évènement</th>
                                        <th>Place(s)</th>
                                        <th>Date</th>
                                        <th>Statut</th>
                                        <th>&nbsp;</th>
                                    </tr>

                                    </thead>

                                    <tbody>

                                        {% for participant in participants | reverse %}

                                            {% for event in events %}

                                                {% if participant.event==event %}

                                                    <tr class="alert" role="alert">

                                                        <td>
                                                            <a href="{{ path('app_user_view_event', {'id': event.id}) }}">
                                                                {{ event.name }}
                                                            </a>
                                                        </td>
                                                        <td>{{ participant.participant }}</td>
                                                        <td class="col-sm-2">{{ event.date | date('d/m/Y') }}</td>
                                                        <td>
                                                            {% if event.status == 'Ouvert' %}
                                                                <span class="badge rounded-pill text-bg-success">{{ event.status }}</span>

                                                            {% elseif event.status == 'Annulé'%}
                                                                <span class="badge rounded-pill text-bg-danger">{{ event.status }}</span>

                                                            {% else %}
                                                                <span class="badge rounded-pill text-bg-secondary">{{ event.status }}</span>

                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            <a href="{{ path('app_user_delete_inscription', {'id' : participant.id}) }}">
                                                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="25" height="25" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ff2825" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                    <line x1="4" y1="7" x2="20" y2="7" />
                                                                    <line x1="10" y1="11" x2="10" y2="17" />
                                                                    <line x1="14" y1="11" x2="14" y2="17" />
                                                                    <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                                                    <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                                                </svg>
                                                            </a>
                                                        </td>

                                                    </tr>

                                                {% endif %}

                                            {% endfor %} <!-- END FOR EVENT -->

                                            {% else %}
                                                <tr>
                                                    <td colspan="5" style="text-align:center;">Vous ne participez à aucun évènement pour le moment</td>
                                                </tr>

                                        {% endfor %} <!-- END FOR PARTICIPANT -->

                                    </tbody>

                                </table>

                            </div>

                        </div>

                    </div>

                </div>

                <!-- REVIEW -->
                <style>
                    .review tbody td{
                        border-bottom: 1px solid #C7C7C7FF;
                        padding: 20px 0 !important;
                    }
                </style>
                <div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="reviewTab">

                    <div class="row">

                        <h2>Vos avis</h2>

                        <div class="col-md-12">

                            <div class="table-wrap">

                                <table class="review table table-hover table-responsive-sm">

                                    <thead>

                                        <tr>
                                            <th>Votre avis</th>
                                            <th>Date</th>
                                            <th>Heure</th>
                                            <th>&nbsp;</th>
                                        </tr>

                                    </thead>

                                    <tbody>

                                        {% for review in reviews | reverse %}

                                            <tr>

                                                <td class="col-sm-6 col-md-8">{{ review.message }}</td>
                                                <td class="col-sm-2">{{ review.createdAt | date('d/m/Y') }}</td>
                                                <td class="col-sm-2">{{ review.createdAt | date('H:i') }}</td>
                                                <td class="col-sm-2">
                                                    <div class="actions">
                                                        <a href="{{ path('app_user_delete_review', {'id': review.id}) }}">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="25" height="25" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ff2825" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                <line x1="4" y1="7" x2="20" y2="7" />
                                                                <line x1="10" y1="11" x2="10" y2="17" />
                                                                <line x1="14" y1="11" x2="14" y2="17" />
                                                                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                                                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                                            </svg>
                                                        </a>
                                                    </div>

                                                </td>
                                            </tr>

                                            {% else %}
                                                <tr>
                                                    <td colspan="4" style="text-align:center;">Vous n'avez laisser aucun avis pour le moment</td>
                                                </tr>

                                        {% endfor %}

                                    </tbody>

                                </table>

                            </div>

                        </div>

                    </div>

                </div>

            </div>

        </main>

    </div>

{% endblock %}